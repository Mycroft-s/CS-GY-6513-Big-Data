<!DOCTYPE html>
<html><head></head><body style="color: rgb(32, 33, 34); font-family: verdana, sans-serif; font-size: 12px;"><p><span style="font-size: 17px;">As mentioned in class, the Python reducer code shown in class, although syntactically correct will not work in Hadoop, as it is building a list behind the scenes, so it could run out of memory.</span></p>
<p><span style="font-size: 17px;">I corrected the reducer code, and the code now shown in Brightspace is correct.&nbsp;</span></p>
<p><span style="font-size: 17px;"><strong>Things to know:</strong></span></p>
<p><span style="font-size: 17px;">1.</span></p>
<p><span style="font-size: 17px;">We learned that the input to a reducer is of the form&nbsp;<code><strong>key, [value, value, ...]</strong></code> .&nbsp;</span><br><span style="font-size: 17px;">However, in Hadoop streaming, the input to the streaming reducer is coming as text files. </span><br><span style="font-size: 17px;">Hadoop will actually compose this file as one <code>K,V</code> <strong>per line.</strong></span></p>
<p><span style="font-size: 17px;">For example, if the original sequence is&nbsp;</span></p>
<p><span style="font-size: 17px;"><code>apple \t [1, 1, 2, 1]<br>tomato \t [2,1,1,2]</code><code></code>&nbsp;</span></p>
<p><span style="font-size: 17px;">in Hadoop streaming, the input to the reducer will be a text file as follows:</span></p>
<p><span style="font-size: 17px;"><code>apple \t 1<br>apple \t 1<br>apple \t 2<br>apple \t 1<br>tomato \t 2<br>tomato \t 1<br>tomato \t 1<br>tomato \t 2<br></code></span></p>
<p><span style="font-size: 17px;">2.&nbsp;</span></p>
<p><span style="font-size: 17px;">The rules of reducer instances will still apply. A single reducer is not guaranteed different keys, both <code>apple</code> and <code>tomato</code> in our example. But it is guaranteed all the lines for, say, <code>apple</code>.&nbsp;</span></p></body></html>